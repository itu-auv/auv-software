<?xml version="1.0"?>
<launch>
  <arg name="namespace" default="taluy_mini" />
  <arg name="control_rate" default="20.0" />
  <arg name="dvl_virtual_port" default="TODO" />
  <arg name="use_gui" default="false" />
  <arg name="enable_logging" default="true" />
  <arg name="logging_directory" default="$(optenv HOME)/bags" />

    <!-- launch expansion bridge -->
    <include file="$(find auv_bringup)/launch/inc/boards/start_expansion_board_bridge.launch.xml">
      <arg name="namespace" value="$(arg namespace)" />
      <arg name="baudrate" value="912600" />
      <arg name="port" value="/dev/auv_taluymini_mainboard" />
      <arg name="virtual_port" value="$(arg dvl_virtual_port)" />
    </include>

      <!-- launch xsens driver -->
    <include file="$(find auv_bringup)/launch/inc/sensors/start_xsens_driver.launch.xml">
      <arg name="namespace" value="$(arg namespace)" />
      <arg name="control_rate" value="$(arg control_rate)" />
      <arg name="port" value="/dev/auv_imu" />
    </include>

  <group ns="$(arg namespace)">
    <include file="$(find auv_detection)/launch/camera_pose.launch" />

    <node pkg="auv_control" type="visual_servoing_controller.py" name="visual_servoing_controller" output="screen">
      <remap from="imu/data" to="sensors/imu/data" />
      <remap from="props_yaw" to="props_yaw" />
      <remap from="cmd_vel" to="cmd_vel" />
      <remap from="enable" to="enable" />
      <remap from="visual_servoing/error" to="visual_servoing/error" />
      <remap from="visual_servoing/current_yaw" to="visual_servoing/current_yaw" />
      <remap from="visual_servoing/target_yaw" to="visual_servoing/target_yaw" />
    </node>

  </group>


    <!-- launch modem serial bridge -->
    <!-- <include file="$(find auv_bringup)/launch/inc/boards/start_modem_serial_bridge.launch.xml">
      <arg name="namespace" value="$(arg namespace)" />
      <arg name="port" value="/dev/auv_taluymini_modem" />
      <arg name="baudrate" value="921600" />
      <arg name="respawn" value="true" />
    </include> -->
</launch>
